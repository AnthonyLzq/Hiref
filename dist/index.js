!function(e){var r={};function t(s){if(r[s])return r[s].exports;var n=r[s]={i:s,l:!1,exports:{}};return e[s].call(n.exports,n,n.exports,t),n.l=!0,n.exports}t.m=e,t.c=r,t.d=function(e,r,s){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:s})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(t.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var n in e)t.d(s,n,function(r){return e[r]}.bind(null,n));return s},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},t.p="/dist/",t(t.s=8)}([function(e,r){e.exports=require("mongoose")},function(e,r){e.exports=require("express")},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.response=void 0;r.response=function(e,r,t,s){t.status(s).send({error:e,message:r})}},function(e,r,t){"use strict";var s,n,o,i,a;Object.defineProperty(r,"__esModule",{value:!0}),r.ErrorMessagesForTasksController=r.ErrorMessagesForProjectsController=r.ErrorMessagesForJobOffersController=r.ErrorMessagesForJobsController=r.GeneralErrorMessages=void 0,function(e){e.invalidDate="Invalid Date",e.missingCode="Code must be provided.",e.missingDeadline="Deadline must be provided.",e.missingDescription="Description must be provided.",e.missingIdCompany="Id Company must be provided.",e.missingIdProject="Id project must be provided.",e.missingStatus="Status must be provided.",e.problemUpdatingStatus="There was a problem trying to update the status.",e.statusNotAllowed="That status is not allowed."}(s||(s={})),r.GeneralErrorMessages=s,function(e){e.problemGettingAll="There was a problem getting all the jobs."}(n||(n={})),r.ErrorMessagesForJobsController=n,function(e){e.missingApplicants="Applicants must be provided.",e.missingCommercialName="The commercial company name must be provided.",e.missingCompletedOrInEvaluationArray="Completed or in evaluation array are missing.",e.missingOccupations="Occupations must be provided.",e.missingRoles="Roles must be provided.",e.problemAllowingTheUserPostulate="There was a problem trying to allow the postulation.",e.problemDeletingJobOffer="There was a problem deleting the job offer",e.problemGettingAll="There was a problem getting all the job offers",e.problemGettingAllByOccupations="There was a problem getting all the job offers for the requested project.",e.problemGettingAllByProject="There was a problem getting all the job offers for the requested project.",e.problemGettingAllForAspirant="There was a problem getting all the job offers for the requested aspirant.",e.problemGettingAllForEvaluator="There was a problem getting all the job offers for the requested aspirant.",e.problemStoringJobOffers="There was a problem trying to store the requested job offer."}(o||(o={})),r.ErrorMessagesForJobOffersController=o,function(e){e.missingSupervisor="Supervisor(s) must be provided.",e.problemGettingAllByCompany="There was a problem getting all the projects from the requested company.",e.problemGettingAllByStatus="There was a problem getting all the projects from the requested company int he requested status.",e.problemGettingOneById="There was a problem getting the requested project.",e.problemStoringProjects="There was a problem trying to store the project.",e.problemUpdatingProjects="There was a problem trying to update the project.",e.projectDoesNoExists="The requested project does not exist."}(i||(i={})),r.ErrorMessagesForProjectsController=i,function(e){e.missingResponsible="Responsible must be provided.",e.missingSubTasks="Sub tasks must be provided.",e.problemDeletingTasks="There was a problem deleting the task.",e.problemGettingAll="There was a problem getting all the tasks.",e.problemStoringTasks="There was a problem trying to store the task.",e.problemUpdatingTasks="There was a problem trying to update the task."}(a||(a={})),r.ErrorMessagesForTasksController=a},function(e,r,t){"use strict";var s=this&&this.__assign||function(){return(s=Object.assign||function(e){for(var r,t=1,s=arguments.length;t<s;t++)for(var n in r=arguments[t])Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n]);return e}).apply(this,arguments)};Object.defineProperty(r,"__esModule",{value:!0}),r.extendSchema=void 0;var n=t(0),o=t(5);r.extendSchema=function(e,r){var t=new n.Schema(s(s({},o.CommonDataForProjectsTasksAndJobOffers.obj),{status:{enum:r,required:!0,type:String}}));return new n.Schema(s(s({},e.obj),t.obj))}},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.CommonDataForProjectsTasksAndJobOffers=void 0;var s=t(0),n=t(6),o=new s.Schema({deadline:{required:!0,type:Date},description:{required:!0,type:n.Information}},{timestamps:{createdAt:!0,updatedAt:!0}});r.CommonDataForProjectsTasksAndJobOffers=o},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Information=void 0;var s=new(t(0).Schema)({content:{required:!0,type:String},title:{required:!0,type:String}},{_id:!1});r.Information=s},function(e,r,t){"use strict";var s=this&&this.__awaiter||function(e,r,t,s){return new(t||(t=Promise))((function(n,o){function i(e){try{u(s.next(e))}catch(e){o(e)}}function a(e){try{u(s.throw(e))}catch(e){o(e)}}function u(e){var r;e.done?n(e.value):(r=e.value,r instanceof t?r:new t((function(e){e(r)}))).then(i,a)}u((s=s.apply(e,r||[])).next())}))},n=this&&this.__generator||function(e,r){var t,s,n,o,i={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,s&&(n=2&o[0]?s.return:o[0]?s.throw||((n=s.return)&&n.call(s),0):s.next)&&!(n=n.call(s,o[1])).done)return n;switch(s=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,s=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(n=i.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){i.label=o[1];break}if(6===o[0]&&i.label<n[1]){i.label=n[1],n=o;break}if(n&&i.label<n[2]){i.label=n[2],i.ops.push(o);break}n[2]&&i.ops.pop(),i.trys.pop();continue}o=r.call(e,i)}catch(e){o=[6,e],s=0}finally{t=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(r,"__esModule",{value:!0}),r.Projects=void 0;var o=t(20),i=t(3),a=function(){function e(e){void 0===e&&(e=null),this._args=e}return e.prototype.process=function(e){switch(e){case"getAllByCompany":return this._getAllByCompany();case"getAllByStatus":return this._getAllByStatus();case"getOneById":return this._getOneById();case"getSupervisorsIdByProject":return this._getSupervisorsByProject();case"store":return this._store();case"update":return this._update();case"updateStatus":return this._updateStatus();default:return}},e.prototype._getAllByCompany=function(){return s(this,void 0,void 0,(function(){var e,r;return n(this,(function(t){switch(t.label){case 0:e=this._args.idCompany,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,o.ProjectsModel.find({idCompany:e})];case 2:return[2,t.sent()];case 3:throw r=t.sent(),console.error(r),new Error(i.ErrorMessagesForProjectsController.problemGettingAllByCompany);case 4:return[2]}}))}))},e.prototype._getAllByStatus=function(){return s(this,void 0,void 0,(function(){var e,r,t,s;return n(this,(function(n){switch(n.label){case 0:e=this._args,r=e.idCompany,t=e.status,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,o.ProjectsModel.find({idCompany:r,status:t})];case 2:return[2,n.sent()];case 3:throw s=n.sent(),console.error(s),new Error(i.ErrorMessagesForProjectsController.problemGettingAllByStatus);case 4:return[2]}}))}))},e.prototype._getOneById=function(){return s(this,void 0,void 0,(function(){var e,r,t;return n(this,(function(s){switch(s.label){case 0:e=this._args.id,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,o.ProjectsModel.findById(e)];case 2:if(!(r=s.sent()))throw new Error(i.ErrorMessagesForProjectsController.projectDoesNoExists);return[2,r];case 3:if((t=s.sent()).message===i.ErrorMessagesForProjectsController.projectDoesNoExists)throw t;throw console.error(t),new Error(i.ErrorMessagesForProjectsController.problemGettingOneById);case 4:return[2]}}))}))},e.prototype._getSupervisorsByProject=function(){return s(this,void 0,void 0,(function(){var e,r,t;return n(this,(function(s){switch(s.label){case 0:e=this._args.id,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,o.ProjectsModel.findById(e,"-_id supervisors")];case 2:if(!(r=s.sent()))throw new Error(i.ErrorMessagesForProjectsController.projectDoesNoExists);return[2,r];case 3:if((t=s.sent()).message===i.ErrorMessagesForProjectsController.projectDoesNoExists)throw t;throw console.error(t),new Error(i.ErrorMessagesForProjectsController.problemGettingOneById);case 4:return[2]}}))}))},e.prototype._store=function(){return s(this,void 0,void 0,(function(){var e,r,t,s,a,u,c;return n(this,(function(n){switch(n.label){case 0:e=this._args,r=e.code,t=e.deadline,s=e.description,a=e.idCompany,u=e.supervisors,n.label=1;case 1:if(n.trys.push([1,3,,4]),!r)throw new Error(i.GeneralErrorMessages.missingCode);if(!t)throw new Error(i.GeneralErrorMessages.missingDeadline);if("Invalid Date"===new Date(t).toString())throw new Error(i.GeneralErrorMessages.invalidDate);if(!a)throw new Error(i.GeneralErrorMessages.missingIdCompany);if(!s)throw new Error(i.GeneralErrorMessages.missingDescription);if(!u)throw new Error(i.ErrorMessagesForProjectsController.missingSupervisor);return[4,new o.ProjectsModel({code:r,deadline:new Date(t),description:s,idCompany:a,status:"active",supervisors:u}).save()];case 2:return[2,n.sent()];case 3:throw(c=n.sent()).message===i.GeneralErrorMessages.missingCode||c.message===i.GeneralErrorMessages.missingDeadline||c.message===i.GeneralErrorMessages.invalidDate||c.message===i.GeneralErrorMessages.missingIdCompany||c.message===i.GeneralErrorMessages.missingDescription||c.message===i.ErrorMessagesForProjectsController.missingSupervisor?c:(console.error(c),new Error(i.ErrorMessagesForProjectsController.problemStoringProjects));case 4:return[2]}}))}))},e.prototype._update=function(){return s(this,void 0,void 0,(function(){var e,r,t,s,a,u,c,l;return n(this,(function(n){switch(n.label){case 0:e=this._args,r=e.code,t=e.deadline,s=e.description,a=e.id,u=e.status,c=e.supervisors,n.label=1;case 1:if(n.trys.push([1,3,,4]),!r)throw new Error(i.GeneralErrorMessages.missingCode);if(!t)throw new Error(i.GeneralErrorMessages.missingDeadline);if("Invalid Date"===new Date(t).toString())throw new Error(i.GeneralErrorMessages.invalidDate);if(!s)throw new Error(i.GeneralErrorMessages.missingDescription);if(!c)throw new Error(i.ErrorMessagesForProjectsController.missingSupervisor);if(!u)throw new Error(i.GeneralErrorMessages.missingStatus);if(!o.STATUS_NAMES.includes(u))throw new Error(i.GeneralErrorMessages.statusNotAllowed);return[4,o.ProjectsModel.findByIdAndUpdate(a,{code:r,deadline:new Date(t),description:s,id:a,status:u,supervisors:c},{new:!0})];case 2:return[2,n.sent()];case 3:throw(l=n.sent()).message===i.GeneralErrorMessages.missingCode||l.message===i.GeneralErrorMessages.missingDeadline||l.message===i.GeneralErrorMessages.invalidDate||l.message===i.GeneralErrorMessages.missingDescription||l.message===i.ErrorMessagesForProjectsController.missingSupervisor||l.message===i.GeneralErrorMessages.statusNotAllowed?l:(console.error(l),new Error(i.ErrorMessagesForProjectsController.problemUpdatingProjects));case 4:return[2]}}))}))},e.prototype._updateStatus=function(){return s(this,void 0,void 0,(function(){var e,r,t,s;return n(this,(function(n){switch(n.label){case 0:e=this._args,r=e.id,t=e.status,n.label=1;case 1:if(n.trys.push([1,3,,4]),!o.STATUS_NAMES.includes(t))throw new Error(i.GeneralErrorMessages.statusNotAllowed);return[4,o.ProjectsModel.findByIdAndUpdate(r,{status:t},{new:!0})];case 2:return[2,n.sent()];case 3:throw s=n.sent(),console.error(s),new Error(i.GeneralErrorMessages.problemUpdatingStatus);case 4:return[2]}}))}))},e}();r.Projects=a},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),t(9).Server.start()},function(e,r,t){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.Server=void 0;var n=s(t(1)),o=s(t(10)),i=t(11),a=t(28),u=t(32),c=t(33),l=new(function(){function e(){this.app=n.default(),this._config()}return e.prototype._config=function(){this.app.set("port",process.env.PORT||"3000"),this.app.use(o.default("dev")),this.app.use(n.default.json()),this.app.use(n.default.urlencoded({extended:!1})),this.app.use((function(e,r,t){r.header("Access-Control-Allow-Origin","*"),r.header("Access-Control-Allow-Headers","Authorization, Content-Type"),t()})),i.applyRoutes(this.app)},e.prototype._firebase=function(){this._firebaseConnection=a.firebaseConnection,this._firebaseConnection()},e.prototype._mongo=function(){this._mongoConnection=u.mongoConnection,this._mongoConnection()},e.prototype._mysql=function(){this._mysqlConnection=c.mysqlConnection,this._mysqlConnection()},e.prototype.start=function(){var e=this;this.app.listen(this.app.get("port"),(function(){return console.log("Server running at port "+e.app.get("port")+".")}));try{this._firebase(),this._mongo(),this._mysql()}catch(e){console.error(e)}},e}());r.Server=l},function(e,r){e.exports=require("morgan")},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.applyRoutes=void 0;var s=t(12),n=[s.JobOffers,s.Jobs,s.Projects,s.Tasks,s.Users];r.applyRoutes=function(e){e.use("/",s.Home),n.forEach((function(r){return e.use("/api",r)}))}},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Users=r.Tasks=r.Projects=r.JobOffers=r.Jobs=r.Home=void 0;var s=t(13);Object.defineProperty(r,"Home",{enumerable:!0,get:function(){return s.Home}});var n=t(14);Object.defineProperty(r,"Jobs",{enumerable:!0,get:function(){return n.Jobs}});var o=t(16);Object.defineProperty(r,"JobOffers",{enumerable:!0,get:function(){return o.JobOffers}});var i=t(19);Object.defineProperty(r,"Projects",{enumerable:!0,get:function(){return i.Projects}});var a=t(21);Object.defineProperty(r,"Tasks",{enumerable:!0,get:function(){return a.Tasks}});var u=t(25);Object.defineProperty(r,"Users",{enumerable:!0,get:function(){return u.Users}})},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Home=void 0;var s=t(1),n=t(2),o=s.Router();r.Home=o,o.route("").get((function(e,r){n.response(!1,"Welcome to Hiref's backend!",r,200)}))},function(e,r,t){"use strict";var s=this&&this.__awaiter||function(e,r,t,s){return new(t||(t=Promise))((function(n,o){function i(e){try{u(s.next(e))}catch(e){o(e)}}function a(e){try{u(s.throw(e))}catch(e){o(e)}}function u(e){var r;e.done?n(e.value):(r=e.value,r instanceof t?r:new t((function(e){e(r)}))).then(i,a)}u((s=s.apply(e,r||[])).next())}))},n=this&&this.__generator||function(e,r){var t,s,n,o,i={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,s&&(n=2&o[0]?s.return:o[0]?s.throw||((n=s.return)&&n.call(s),0):s.next)&&!(n=n.call(s,o[1])).done)return n;switch(s=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,s=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(n=i.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){i.label=o[1];break}if(6===o[0]&&i.label<n[1]){i.label=n[1],n=o;break}if(n&&i.label<n[2]){i.label=n[2],i.ops.push(o);break}n[2]&&i.ops.pop(),i.trys.pop();continue}o=r.call(e,i)}catch(e){o=[6,e],s=0}finally{t=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(r,"__esModule",{value:!0}),r.Jobs=void 0;var o=t(1),i=t(2),a=t(15),u=o.Router();r.Jobs=u,u.route("/jobs/").get((function(e,r){return s(void 0,void 0,void 0,(function(){var e,t,s;return n(this,(function(n){switch(n.label){case 0:e=new a.Jobs,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,e.process("getAll")];case 2:return t=n.sent(),i.response(!1,{result:t},r,200),[3,4];case 3:return s=n.sent(),i.response(!0,s.message,r,500),[3,4];case 4:return[2]}}))}))}))},function(e,r,t){"use strict";var s=this&&this.__awaiter||function(e,r,t,s){return new(t||(t=Promise))((function(n,o){function i(e){try{u(s.next(e))}catch(e){o(e)}}function a(e){try{u(s.throw(e))}catch(e){o(e)}}function u(e){var r;e.done?n(e.value):(r=e.value,r instanceof t?r:new t((function(e){e(r)}))).then(i,a)}u((s=s.apply(e,r||[])).next())}))},n=this&&this.__generator||function(e,r){var t,s,n,o,i={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,s&&(n=2&o[0]?s.return:o[0]?s.throw||((n=s.return)&&n.call(s),0):s.next)&&!(n=n.call(s,o[1])).done)return n;switch(s=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,s=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(n=i.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){i.label=o[1];break}if(6===o[0]&&i.label<n[1]){i.label=n[1],n=o;break}if(n&&i.label<n[2]){i.label=n[2],i.ops.push(o);break}n[2]&&i.ops.pop(),i.trys.pop();continue}o=r.call(e,i)}catch(e){o=[6,e],s=0}finally{t=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(r,"__esModule",{value:!0}),r.Jobs=void 0;var o=t(3),i=function(){function e(){this._allJobs=[]}return e.prototype.process=function(e){switch(e){case"getAll":return this._getAll();default:return}},e.prototype._getAll=function(){return s(this,void 0,void 0,(function(){var e,r,t,s=this;return n(this,(function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),[4,global.mysqlDatabase.select("id_jobfamily as id","description as jobFamilyName").from("jobfamily")];case 1:return e=n.sent(),[4,global.mysqlDatabase.select("j.id_jobfamily as jobFamilyId","o.id_ocupation as occupationId","o.description as occupation").from({j:"jobfamily"}).innerJoin({o:"ocupation"},"j.id_jobfamily","=","o.idfk_jobfamily")];case 2:return r=n.sent(),e.forEach((function(e){var t=[];r.forEach((function(r){r.jobFamilyId===e.id&&t.push({occupationId:r.occupationId,occupationName:r.occupation})})),s._allJobs.push({jobFamily:e,occupations:t})})),[2,this._allJobs];case 3:throw t=n.sent(),console.error(t),new Error(o.ErrorMessagesForJobsController.problemGettingAll);case 4:return[2]}}))}))},e}();r.Jobs=i},function(e,r,t){"use strict";var s=this&&this.__assign||function(){return(s=Object.assign||function(e){for(var r,t=1,s=arguments.length;t<s;t++)for(var n in r=arguments[t])Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n]);return e}).apply(this,arguments)},n=this&&this.__awaiter||function(e,r,t,s){return new(t||(t=Promise))((function(n,o){function i(e){try{u(s.next(e))}catch(e){o(e)}}function a(e){try{u(s.throw(e))}catch(e){o(e)}}function u(e){var r;e.done?n(e.value):(r=e.value,r instanceof t?r:new t((function(e){e(r)}))).then(i,a)}u((s=s.apply(e,r||[])).next())}))},o=this&&this.__generator||function(e,r){var t,s,n,o,i={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,s&&(n=2&o[0]?s.return:o[0]?s.throw||((n=s.return)&&n.call(s),0):s.next)&&!(n=n.call(s,o[1])).done)return n;switch(s=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,s=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(n=i.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){i.label=o[1];break}if(6===o[0]&&i.label<n[1]){i.label=n[1],n=o;break}if(n&&i.label<n[2]){i.label=n[2],i.ops.push(o);break}n[2]&&i.ops.pop(),i.trys.pop();continue}o=r.call(e,i)}catch(e){o=[6,e],s=0}finally{t=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(r,"__esModule",{value:!0}),r.JobOffers=void 0;var i=t(1),a=t(2),u=t(17),c=i.Router();r.JobOffers=c,c.route("/jobOffers/").get((function(e,r){return n(void 0,void 0,void 0,(function(){var e,t,s;return o(this,(function(n){switch(n.label){case 0:e=new u.JobOffers,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,e.process("getAll")];case 2:return t=n.sent(),a.response(!1,{result:t},r,200),[3,4];case 3:return s=n.sent(),a.response(!0,s.message,r,500),[3,4];case 4:return[2]}}))}))})),c.route("/jobOffers/store/:idProject/").post((function(e,r){return n(void 0,void 0,void 0,(function(){var t,n,i,c,l;return o(this,(function(o){switch(o.label){case 0:t=e.body.args,n=e.params.idProject,i=new u.JobOffers(s(s({},t),{idProject:n})),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,i.process("store")];case 2:return c=o.sent(),a.response(!1,{result:c},r,200),[3,4];case 3:return l=o.sent(),a.response(!0,l.message,r,500),[3,4];case 4:return[2]}}))}))})),c.route("/jobOffers/update/:idJobOffer/").patch((function(e,r){return n(void 0,void 0,void 0,(function(){var t,n,i,c,l,f,p,d;return o(this,(function(o){switch(o.label){case 0:if(t=e.body.args,n=e.params.idJobOffer,(i=e.query)&&0!==Object.keys(i).length)return[3,5];c=new u.JobOffers(s(s({},t),{id:n})),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,c.process("update")];case 2:return l=o.sent(),a.response(!1,{result:l},r,200),[3,4];case 3:return f=o.sent(),a.response(!0,f.message,r,500),[3,4];case 4:return[3,9];case 5:p=i.status,c=new u.JobOffers({id:n,status:p}),o.label=6;case 6:return o.trys.push([6,8,,9]),[4,c.process("updateStatus")];case 7:return l=o.sent(),a.response(!1,{result:l},r,200),[3,9];case 8:return d=o.sent(),a.response(!0,d.message,r,500),[3,9];case 9:return[2]}}))}))})),c.route("/jobOffers/getAll/byProject/:idProject/").get((function(e,r){return n(void 0,void 0,void 0,(function(){var t,s,n,i;return o(this,(function(o){switch(o.label){case 0:t=e.params.idProject,s=new u.JobOffers({idProject:t}),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,s.process("getAllByProject")];case 2:return n=o.sent(),a.response(!1,{result:n},r,200),[3,4];case 3:return i=o.sent(),a.response(!0,i.message,r,500),[3,4];case 4:return[2]}}))}))})),c.route("/jobOffers/getAll/byOccupations/").post((function(e,r){return n(void 0,void 0,void 0,(function(){var t,s,n,i;return o(this,(function(o){switch(o.label){case 0:t=e.body.args,s=new u.JobOffers(t),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,s.process("getAllByOccupations")];case 2:return n=o.sent(),a.response(!1,{result:n},r,200),[3,4];case 3:return i=o.sent(),a.response(!0,i.message,r,500),[3,4];case 4:return[2]}}))}))})),c.route("/jobOffers/getAll/forAspirant/").post((function(e,r){return n(void 0,void 0,void 0,(function(){var t,s,n,i;return o(this,(function(o){switch(o.label){case 0:t=e.body.args,s=new u.JobOffers(t),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,s.process("getAllForAspirant")];case 2:return n=o.sent(),a.response(!1,{result:n},r,200),[3,4];case 3:return i=o.sent(),a.response(!0,i.message,r,500),[3,4];case 4:return[2]}}))}))})),c.route("/jobOffers/getAll/forEvaluator/").post((function(e,r){return n(void 0,void 0,void 0,(function(){var t,s,n,i;return o(this,(function(o){switch(o.label){case 0:t=e.body.args,s=new u.JobOffers(t),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,s.process("getAllForEvaluator")];case 2:return n=o.sent(),a.response(!1,{result:n},r,200),[3,4];case 3:return i=o.sent(),a.response(!0,i.message,r,500),[3,4];case 4:return[2]}}))}))})),c.route("/jobOffers/delete/:idJobOffer/").delete((function(e,r){return n(void 0,void 0,void 0,(function(){var t,s,n,i;return o(this,(function(o){switch(o.label){case 0:t=e.params.idJobOffer,s=new u.JobOffers({id:t}),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,s.process("deleteOne")];case 2:return n=o.sent(),a.response(!1,{result:n},r,200),[3,4];case 3:return i=o.sent(),a.response(!0,i.message,r,500),[3,4];case 4:return[2]}}))}))})),c.route("/jobOffers/postulate/:idJobOffer/").post((function(e,r){return n(void 0,void 0,void 0,(function(){var t,n,i,c,l;return o(this,(function(o){switch(o.label){case 0:t=e.body.args,n=e.params.idJobOffer,i=new u.JobOffers(s(s({},t),{id:n})),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,i.process("postulation")];case 2:return c=o.sent(),a.response(!1,{result:c},r,200),[3,4];case 3:return l=o.sent(),a.response(!0,l.message,r,500),[3,4];case 4:return[2]}}))}))}))},function(e,r,t){"use strict";var s=this&&this.__awaiter||function(e,r,t,s){return new(t||(t=Promise))((function(n,o){function i(e){try{u(s.next(e))}catch(e){o(e)}}function a(e){try{u(s.throw(e))}catch(e){o(e)}}function u(e){var r;e.done?n(e.value):(r=e.value,r instanceof t?r:new t((function(e){e(r)}))).then(i,a)}u((s=s.apply(e,r||[])).next())}))},n=this&&this.__generator||function(e,r){var t,s,n,o,i={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,s&&(n=2&o[0]?s.return:o[0]?s.throw||((n=s.return)&&n.call(s),0):s.next)&&!(n=n.call(s,o[1])).done)return n;switch(s=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,s=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(n=i.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){i.label=o[1];break}if(6===o[0]&&i.label<n[1]){i.label=n[1],n=o;break}if(n&&i.label<n[2]){i.label=n[2],i.ops.push(o);break}n[2]&&i.ops.pop(),i.trys.pop();continue}o=r.call(e,i)}catch(e){o=[6,e],s=0}finally{t=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},o=this&&this.__read||function(e,r){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var s,n,o=t.call(e),i=[];try{for(;(void 0===r||r-- >0)&&!(s=o.next()).done;)i.push(s.value)}catch(e){n={error:e}}finally{try{s&&!s.done&&(t=o.return)&&t.call(o)}finally{if(n)throw n.error}}return i},i=this&&this.__spread||function(){for(var e=[],r=0;r<arguments.length;r++)e=e.concat(o(arguments[r]));return e};Object.defineProperty(r,"__esModule",{value:!0}),r.JobOffers=void 0;var a=t(0),u=t(18),c=t(3),l=function(){function e(e){void 0===e&&(e=null),this._args=e}return e.prototype.process=function(e){switch(e){case"deleteOne":return this._deleteOne();case"getAll":return this._getAll();case"getAllByProject":return this._getAllByProject();case"getAllByOccupations":return this._getAllByOccupations();case"getAllForAspirant":return this._getAllForAspirant();case"getAllForEvaluator":return this._getAllForEvaluator();case"postulation":return this._postulation();case"store":return this._store();case"update":return this._update();case"updateStatus":return this._updateStatus();default:return}},e.prototype._deleteOne=function(){return s(this,void 0,void 0,(function(){var e,r;return n(this,(function(t){switch(t.label){case 0:e=this._args.id,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,u.JobOffersModel.findByIdAndDelete(e)];case 2:return[2,t.sent()];case 3:throw r=t.sent(),console.error(r),new Error(c.ErrorMessagesForJobOffersController.problemDeletingJobOffer);case 4:return[2]}}))}))},e.prototype._getAll=function(){return s(this,void 0,void 0,(function(){var e;return n(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,u.JobOffersModel.find({$or:[{status:"published"},{status:"rePublished"}]})];case 1:return[2,r.sent()];case 2:throw e=r.sent(),console.error(e),new Error(c.ErrorMessagesForJobOffersController.problemGettingAll);case 3:return[2]}}))}))},e.prototype._getAllByProject=function(){return s(this,void 0,void 0,(function(){var e,r;return n(this,(function(t){switch(t.label){case 0:e=this._args.idProject,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,u.JobOffersModel.find({idProject:new a.Types.ObjectId(e)})];case 2:return[2,t.sent()];case 3:throw r=t.sent(),console.error(r),new Error(c.ErrorMessagesForJobOffersController.problemGettingAllByProject);case 4:return[2]}}))}))},e.prototype._getAllByOccupations=function(){return s(this,void 0,void 0,(function(){var e,r;return n(this,(function(t){switch(t.label){case 0:e=this._args.occupations,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,u.JobOffersModel.find({occupations:{$in:e}})];case 2:return[2,t.sent()];case 3:throw r=t.sent(),console.error(r),new Error(c.ErrorMessagesForJobOffersController.problemGettingAllByOccupations);case 4:return[2]}}))}))},e.prototype._getAllForAspirant=function(){return s(this,void 0,void 0,(function(){var e,r,t,s,o,l,f,p,d;return n(this,(function(n){switch(n.label){case 0:console.log(this._args),e=this._args,r=e.accepted,t=e.occupations,s=e.rejected,n.label=1;case 1:if(n.trys.push([1,9,,10]),!t||0===t.length)throw new Error(c.ErrorMessagesForJobOffersController.missingOccupations);return o=void 0,r.length>0&&s.length>0&&t.length>0?(f=r.map((function(e){return new a.Types.ObjectId(e)})),p=s.map((function(e){return new a.Types.ObjectId(e)})),l=i(f,p),[4,Promise.all([u.JobOffersModel.find({_id:{$nin:l},occupations:{$in:t}}),u.JobOffersModel.find({_id:{$in:f},occupations:{$in:t}}),u.JobOffersModel.find({_id:{$in:p},occupations:{$in:t}})])]):[3,3];case 2:return[2,{acceptedJobOffers:(o=n.sent())[1],availableJobOffers:o[0],rejectedJobOffers:o[2]}];case 3:return r.length>0&&t.length>0?(f=r.map((function(e){return new a.Types.ObjectId(e)})),[4,Promise.all([u.JobOffersModel.find({_id:{$nin:f},occupations:{$in:t}}),u.JobOffersModel.find({_id:{$in:f},occupations:{$in:t}})])]):[3,5];case 4:return[2,{acceptedJobOffers:(o=n.sent())[1],availableJobOffers:o[0],rejectedJobOffers:[]}];case 5:return s.length>0&&t.length>0?(p=r.map((function(e){return new a.Types.ObjectId(e)})),[4,Promise.all([u.JobOffersModel.find({_id:{$nin:p},occupations:{$in:t}}),u.JobOffersModel.find({_id:{$in:p},occupations:{$in:t}})])]):[3,7];case 6:return[2,{acceptedJobOffers:[],availableJobOffers:(o=n.sent())[0],rejectedJobOffers:o[1]}];case 7:return[4,u.JobOffersModel.find({occupations:{$in:t}})];case 8:return[2,{acceptedJobOffers:[],availableJobOffers:o=n.sent(),rejectedJobOffers:[]}];case 9:if((d=n.sent()).message===c.ErrorMessagesForJobOffersController.missingOccupations)throw d;throw console.error(d),new Error(c.ErrorMessagesForJobOffersController.problemGettingAllForAspirant);case 10:return[2]}}))}))},e.prototype._getAllForEvaluator=function(){return s(this,void 0,void 0,(function(){var e,r,t,s,o,l,f,p;return n(this,(function(n){switch(n.label){case 0:e=this._args,r=e.completed,t=e.inEvaluation,n.label=1;case 1:return n.trys.push([1,9,,10]),s=void 0,r.length>0&&t.length>0?(l=r.map((function(e){return new a.Types.ObjectId(e)})),f=t.map((function(e){return new a.Types.ObjectId(e)})),o=i(l,f),[4,Promise.all([u.JobOffersModel.find({$or:[{status:"published"},{status:"rePublished"}],_id:{$in:o}}),u.JobOffersModel.find({$or:[{status:"published"},{status:"rePublished"}],_id:{$in:l}}),u.JobOffersModel.find({$or:[{status:"published"},{status:"rePublished"}],_id:{$in:f}})])]):[3,3];case 2:return[2,{availableJobOffers:(s=n.sent())[0],completedJobOffers:s[1],inEvaluationJobOffers:s[2]}];case 3:return r.length>0?(l=r.map((function(e){return new a.Types.ObjectId(e)})),[4,Promise.all([u.JobOffersModel.find({$or:[{status:"published"},{status:"rePublished"}],_id:{$nin:l}}),u.JobOffersModel.find({$or:[{status:"published"},{status:"rePublished"}],_id:{$in:l}})])]):[3,5];case 4:return[2,{availableJobOffers:(s=n.sent())[0],completedJobOffers:s[1],inEvaluationJobOffers:[]}];case 5:return t.length>0?(f=t.map((function(e){return new a.Types.ObjectId(e)})),[4,Promise.all([u.JobOffersModel.find({$or:[{status:"published"},{status:"rePublished"}],_id:{$nin:f}}),u.JobOffersModel.find({$or:[{status:"published"},{status:"rePublished"}],_id:{$in:f}})])]):[3,7];case 6:return[2,{availableJobOffers:(s=n.sent())[0],completedJobOffers:[],inEvaluationJobOffers:s[1]}];case 7:return[4,u.JobOffersModel.find({$or:[{status:"published"},{status:"rePublished"}]})];case 8:return[2,{availableJobOffers:s=n.sent(),completedJobOffers:[],inEvaluationJobOffers:[]}];case 9:throw p=n.sent(),console.error(p),new Error(c.ErrorMessagesForJobOffersController.problemGettingAllForEvaluator);case 10:return[2]}}))}))},e.prototype._store=function(){return s(this,void 0,void 0,(function(){var e,r,t,s,o,i,a,l,f;return n(this,(function(n){switch(n.label){case 0:e=this._args,r=e.code,t=e.commercialName,s=e.deadline,o=e.description,i=e.idProject,a=e.occupations,l=e.roles,n.label=1;case 1:if(n.trys.push([1,3,,4]),!r)throw new Error(c.GeneralErrorMessages.missingCode);if(!t)throw new Error(c.ErrorMessagesForJobOffersController.missingCommercialName);if(!s)throw new Error(c.GeneralErrorMessages.missingDeadline);if("Invalid Date"===new Date(s).toString())throw new Error(c.GeneralErrorMessages.invalidDate);if(!o)throw new Error(c.GeneralErrorMessages.missingDescription);if(!i)throw new Error(c.GeneralErrorMessages.missingIdProject);if(!a)throw new Error(c.ErrorMessagesForJobOffersController.missingOccupations);if(!l)throw new Error(c.ErrorMessagesForJobOffersController.missingRoles);return[4,new u.JobOffersModel({code:r,commercialName:t,deadline:new Date(s),description:o,idProject:i,numberApplicants:0,occupations:a,roles:l,status:"published"}).save()];case 2:return[2,n.sent()];case 3:throw(f=n.sent()).message===c.GeneralErrorMessages.missingCode||f.message===c.GeneralErrorMessages.missingDeadline||f.message===c.GeneralErrorMessages.invalidDate||f.message===c.GeneralErrorMessages.missingDescription||f.message===c.GeneralErrorMessages.missingDescription||f.message===c.GeneralErrorMessages.missingIdProject||f.message===c.ErrorMessagesForJobOffersController.missingOccupations||f.message===c.ErrorMessagesForJobOffersController.missingRoles||f.message===c.GeneralErrorMessages.statusNotAllowed?f:(console.error(f),new Error(c.ErrorMessagesForJobOffersController.problemStoringJobOffers));case 4:return[2]}}))}))},e.prototype._postulation=function(){return s(this,void 0,void 0,(function(){var e,r,t,s,o,i;return n(this,(function(n){switch(n.label){case 0:e=this._args,r=e.id,t=e.roles,n.label=1;case 1:if(n.trys.push([1,3,,4]),!t)throw new Error(c.ErrorMessagesForJobOffersController.missingRoles);return s=t[0].applicants[0],o=t[0].description.title,[4,u.JobOffersModel.findByIdAndUpdate(r,{$addToSet:{"roles.$[r].applicants":s},$inc:{numberApplicants:1}},{arrayFilters:[{"r.description.title":o}],new:!0})];case 2:return[2,n.sent()];case 3:throw(i=n.sent()).message===c.ErrorMessagesForJobOffersController.missingApplicants?i:(console.error(i),new Error(c.ErrorMessagesForJobOffersController.problemAllowingTheUserPostulate));case 4:return[2]}}))}))},e.prototype._update=function(){return s(this,void 0,void 0,(function(){var e,r,t,s,o,i,a,l,f;return n(this,(function(n){switch(n.label){case 0:e=this._args,r=e.code,t=e.deadline,s=e.description,o=e.id,i=e.occupations,a=e.roles,l=e.status,n.label=1;case 1:if(n.trys.push([1,3,,4]),!r)throw new Error(c.GeneralErrorMessages.missingCode);if(!t)throw new Error(c.GeneralErrorMessages.missingDeadline);if("Invalid Date"===new Date(t).toString())throw new Error(c.GeneralErrorMessages.invalidDate);if(!s)throw new Error(c.GeneralErrorMessages.missingDescription);if(!i)throw new Error(c.ErrorMessagesForJobOffersController.missingOccupations);if(!a)throw new Error(c.ErrorMessagesForJobOffersController.missingRoles);if(!l)throw new Error(c.GeneralErrorMessages.missingStatus);if(!u.STATUS_NAMES.includes(l))throw new Error(c.GeneralErrorMessages.statusNotAllowed);return[4,u.JobOffersModel.findByIdAndUpdate(o,{code:r,deadline:new Date(t),description:s,occupations:i,roles:a,status:l},{new:!0})];case 2:return[2,n.sent()];case 3:throw(f=n.sent()).message===c.GeneralErrorMessages.missingCode||f.message===c.GeneralErrorMessages.missingDeadline||f.message===c.GeneralErrorMessages.invalidDate||f.message===c.GeneralErrorMessages.missingDescription||f.message===c.GeneralErrorMessages.missingDescription||f.message===c.ErrorMessagesForJobOffersController.missingOccupations||f.message===c.ErrorMessagesForJobOffersController.missingRoles||f.message===c.GeneralErrorMessages.missingStatus||f.message===c.GeneralErrorMessages.statusNotAllowed?f:(console.error(f),new Error(c.ErrorMessagesForJobOffersController.problemStoringJobOffers));case 4:return[2]}}))}))},e.prototype._updateStatus=function(){return s(this,void 0,void 0,(function(){var e,r,t,s;return n(this,(function(n){switch(n.label){case 0:e=this._args,r=e.id,t=e.status,n.label=1;case 1:if(n.trys.push([1,3,,4]),!u.STATUS_NAMES.includes(t))throw new Error(c.GeneralErrorMessages.statusNotAllowed);return[4,u.JobOffersModel.findByIdAndUpdate(r,{status:t},{new:!0})];case 2:return[2,n.sent()];case 3:throw s=n.sent(),console.error(s),new Error(c.GeneralErrorMessages.problemUpdatingStatus);case 4:return[2]}}))}))},e}();r.JobOffers=l},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.STATUS_NAMES=r.JobOffersModel=void 0;var s=t(0),n=t(4),o=t(6),i=["published","inEvaluation","rePublished","completed","canceled"];r.STATUS_NAMES=i;var a=new s.Schema({applicants:{required:!1,type:[String]},description:{required:!0,type:o.Information},quantity:{required:!0,type:Number},remuneration:{required:!0,type:Number}},{_id:!1}),u=new s.Schema({commercialName:{required:!0,type:String},idProject:{ref:"projects",required:!0,type:s.Schema.Types.ObjectId},numberApplicants:{required:!0,type:Number},occupations:{required:!0,type:[String]},roles:{required:!0,type:[a]}}),c=n.extendSchema(u,i),l=s.model("jobOffers",c);r.JobOffersModel=l},function(e,r,t){"use strict";var s=this&&this.__assign||function(){return(s=Object.assign||function(e){for(var r,t=1,s=arguments.length;t<s;t++)for(var n in r=arguments[t])Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n]);return e}).apply(this,arguments)},n=this&&this.__awaiter||function(e,r,t,s){return new(t||(t=Promise))((function(n,o){function i(e){try{u(s.next(e))}catch(e){o(e)}}function a(e){try{u(s.throw(e))}catch(e){o(e)}}function u(e){var r;e.done?n(e.value):(r=e.value,r instanceof t?r:new t((function(e){e(r)}))).then(i,a)}u((s=s.apply(e,r||[])).next())}))},o=this&&this.__generator||function(e,r){var t,s,n,o,i={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,s&&(n=2&o[0]?s.return:o[0]?s.throw||((n=s.return)&&n.call(s),0):s.next)&&!(n=n.call(s,o[1])).done)return n;switch(s=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,s=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(n=i.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){i.label=o[1];break}if(6===o[0]&&i.label<n[1]){i.label=n[1],n=o;break}if(n&&i.label<n[2]){i.label=n[2],i.ops.push(o);break}n[2]&&i.ops.pop(),i.trys.pop();continue}o=r.call(e,i)}catch(e){o=[6,e],s=0}finally{t=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(r,"__esModule",{value:!0}),r.Projects=void 0;var i=t(1),a=t(2),u=t(7),c=i.Router();r.Projects=c,c.route("/projects/:idCompany/").get((function(e,r){return n(void 0,void 0,void 0,(function(){var t,s,n,i,c,l,f;return o(this,(function(o){switch(o.label){case 0:if(t=e.params.idCompany,(s=e.query)&&0!==Object.keys(s).length)return[3,5];n=new u.Projects({idCompany:t}),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,n.process("getAllByCompany")];case 2:return i=o.sent(),a.response(!1,{result:i},r,200),[3,4];case 3:return c=o.sent(),a.response(!0,c.message,r,500),[3,4];case 4:return[3,9];case 5:l=s.status,n=new u.Projects({idCompany:t,status:l}),o.label=6;case 6:return o.trys.push([6,8,,9]),[4,n.process("getAllByStatus")];case 7:return i=o.sent(),a.response(!1,{result:i},r,200),[3,9];case 8:return f=o.sent(),a.response(!0,f.message,r,500),[3,9];case 9:return[2]}}))}))})).post((function(e,r){return n(void 0,void 0,void 0,(function(){var t,n,i,c,l;return o(this,(function(o){switch(o.label){case 0:t=e.body.args,n=e.params.idCompany,i=new u.Projects(s(s({},t),{idCompany:n})),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,i.process("store")];case 2:return c=o.sent(),a.response(!1,{result:c},r,200),[3,4];case 3:return l=o.sent(),a.response(!0,l.message,r,500),[3,4];case 4:return[2]}}))}))})),c.route("/projects/getById/:idProject/").get((function(e,r){return n(void 0,void 0,void 0,(function(){var t,s,n,i;return o(this,(function(o){switch(o.label){case 0:t=e.params.idProject,s=new u.Projects({id:t}),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,s.process("getOneById")];case 2:return n=o.sent(),a.response(!1,{result:n},r,200),[3,4];case 3:return i=o.sent(),a.response(!0,i.message,r,500),[3,4];case 4:return[2]}}))}))})),c.route("/projects/update/:idProject/").patch((function(e,r){return n(void 0,void 0,void 0,(function(){var t,n,i,c,l,f,p,d;return o(this,(function(o){switch(o.label){case 0:if(t=e.body.args,n=e.params.idProject,(i=e.query)&&0!==Object.keys(i).length)return[3,5];c=new u.Projects(s(s({},t),{id:n})),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,c.process("update")];case 2:return l=o.sent(),a.response(!1,{result:l},r,200),[3,4];case 3:return f=o.sent(),a.response(!0,f.message,r,500),[3,4];case 4:return[3,9];case 5:p=i.status,c=new u.Projects({id:n,status:p}),o.label=6;case 6:return o.trys.push([6,8,,9]),[4,c.process("updateStatus")];case 7:return l=o.sent(),a.response(!1,{result:l},r,200),[3,9];case 8:return d=o.sent(),a.response(!0,d.message,r,500),[3,9];case 9:return[2]}}))}))}))},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.STATUS_NAMES=r.ProjectsModel=void 0;var s=t(0),n=t(4),o=["active","completed","canceled"];r.STATUS_NAMES=o;var i=new s.Schema({code:{required:!1,type:String,unique:!0},idCompany:{required:!0,type:String},supervisors:{required:!0,type:[String]}}),a=n.extendSchema(i,o),u=s.model("projects",a);r.ProjectsModel=u},function(e,r,t){"use strict";var s=this&&this.__assign||function(){return(s=Object.assign||function(e){for(var r,t=1,s=arguments.length;t<s;t++)for(var n in r=arguments[t])Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n]);return e}).apply(this,arguments)},n=this&&this.__awaiter||function(e,r,t,s){return new(t||(t=Promise))((function(n,o){function i(e){try{u(s.next(e))}catch(e){o(e)}}function a(e){try{u(s.throw(e))}catch(e){o(e)}}function u(e){var r;e.done?n(e.value):(r=e.value,r instanceof t?r:new t((function(e){e(r)}))).then(i,a)}u((s=s.apply(e,r||[])).next())}))},o=this&&this.__generator||function(e,r){var t,s,n,o,i={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,s&&(n=2&o[0]?s.return:o[0]?s.throw||((n=s.return)&&n.call(s),0):s.next)&&!(n=n.call(s,o[1])).done)return n;switch(s=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,s=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(n=i.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){i.label=o[1];break}if(6===o[0]&&i.label<n[1]){i.label=n[1],n=o;break}if(n&&i.label<n[2]){i.label=n[2],i.ops.push(o);break}n[2]&&i.ops.pop(),i.trys.pop();continue}o=r.call(e,i)}catch(e){o=[6,e],s=0}finally{t=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(r,"__esModule",{value:!0}),r.Tasks=void 0;var i=t(1),a=t(2),u=t(22),c=i.Router();r.Tasks=c,c.route("/tasks/:idProject/").get((function(e,r){return n(void 0,void 0,void 0,(function(){var t,s,n,i;return o(this,(function(o){switch(o.label){case 0:t=e.params.idProject,s=new u.Tasks({idProject:t}),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,s.process("getAll")];case 2:return n=o.sent(),a.response(!1,{result:n},r,200),[3,4];case 3:return i=o.sent(),a.response(!0,i.message,r,500),[3,4];case 4:return[2]}}))}))})).post((function(e,r){return n(void 0,void 0,void 0,(function(){var t,n,i,c,l;return o(this,(function(o){switch(o.label){case 0:t=e.body.args,n=e.params.idProject,i=new u.Tasks(s(s({},t),{idProject:n})),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,i.process("store")];case 2:return c=o.sent(),a.response(!1,{result:c},r,200),[3,4];case 3:return l=o.sent(),a.response(!0,l.message,r,500),[3,4];case 4:return[2]}}))}))})),c.route("/tasks/:idProject/:idTask/").patch((function(e,r){return n(void 0,void 0,void 0,(function(){var t,n,i,c,l,f,p,d,h,b;return o(this,(function(o){switch(o.label){case 0:if(t=e.body.args,n=e.params,i=n.idProject,c=n.idTask,(l=e.query)&&0!==Object.keys(l).length)return[3,5];f=new u.Tasks(s(s({},t),{id:c,idProject:i})),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,f.process("update")];case 2:return p=o.sent(),a.response(!1,{result:p},r,200),[3,4];case 3:return d=o.sent(),a.response(!0,d.message,r,500),[3,4];case 4:return[3,9];case 5:h=l.status,f=new u.Tasks({id:c,status:h}),o.label=6;case 6:return o.trys.push([6,8,,9]),[4,f.process("updateStatus")];case 7:return p=o.sent(),a.response(!1,{result:p},r,200),[3,9];case 8:return b=o.sent(),a.response(!0,b.message,r,500),[3,9];case 9:return[2]}}))}))})),c.route("/tasks/delete/:idTask/").delete((function(e,r){return n(void 0,void 0,void 0,(function(){var t,s,n,i;return o(this,(function(o){switch(o.label){case 0:t=e.params.idTask,s=new u.Tasks({id:t}),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,s.process("deleteOne")];case 2:return n=o.sent(),a.response(!1,{result:n},r,200),[3,4];case 3:return i=o.sent(),a.response(!0,i.message,r,500),[3,4];case 4:return[2]}}))}))}))},function(e,r,t){"use strict";var s=this&&this.__awaiter||function(e,r,t,s){return new(t||(t=Promise))((function(n,o){function i(e){try{u(s.next(e))}catch(e){o(e)}}function a(e){try{u(s.throw(e))}catch(e){o(e)}}function u(e){var r;e.done?n(e.value):(r=e.value,r instanceof t?r:new t((function(e){e(r)}))).then(i,a)}u((s=s.apply(e,r||[])).next())}))},n=this&&this.__generator||function(e,r){var t,s,n,o,i={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,s&&(n=2&o[0]?s.return:o[0]?s.throw||((n=s.return)&&n.call(s),0):s.next)&&!(n=n.call(s,o[1])).done)return n;switch(s=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,s=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(n=i.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){i.label=o[1];break}if(6===o[0]&&i.label<n[1]){i.label=n[1],n=o;break}if(n&&i.label<n[2]){i.label=n[2],i.ops.push(o);break}n[2]&&i.ops.pop(),i.trys.pop();continue}o=r.call(e,i)}catch(e){o=[6,e],s=0}finally{t=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(r,"__esModule",{value:!0}),r.Tasks=void 0;var o=t(0),i=t(23),a=t(3),u=function(){function e(e){void 0===e&&(e=null),this._args=e}return e.prototype.process=function(e){switch(e){case"deleteOne":return this._deleteOne();case"getAll":return this._getAll();case"store":return this._store();case"update":return this._update();case"updateStatus":return this._updateStatus();default:return}},e.prototype._deleteOne=function(){return s(this,void 0,void 0,(function(){var e,r;return n(this,(function(t){switch(t.label){case 0:e=this._args.id,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,i.TasksModel.findByIdAndDelete(e)];case 2:return[2,t.sent()];case 3:throw r=t.sent(),console.error(r),new Error(a.ErrorMessagesForTasksController.problemDeletingTasks);case 4:return[2]}}))}))},e.prototype._getAll=function(){return s(this,void 0,void 0,(function(){var e,r;return n(this,(function(t){switch(t.label){case 0:e=this._args.idProject,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,i.TasksModel.find({idProject:new o.Types.ObjectId(e)})];case 2:return[2,t.sent()];case 3:throw r=t.sent(),console.error(r),new Error(a.ErrorMessagesForTasksController.problemGettingAll);case 4:return[2]}}))}))},e.prototype._store=function(){return s(this,void 0,void 0,(function(){var e,r,t,s,o,u,c,l;return n(this,(function(n){switch(n.label){case 0:e=this._args,r=e.idProject,t=e.deadline,s=e.description,o=e.responsible,u=e.status,c=e.subTasks,n.label=1;case 1:if(n.trys.push([1,3,,4]),!r)throw new Error(a.GeneralErrorMessages.missingIdProject);if(!t)throw new Error(a.GeneralErrorMessages.missingDeadline);if("Invalid Date"===new Date(t).toString())throw new Error(a.GeneralErrorMessages.invalidDate);if(!s)throw new Error(a.GeneralErrorMessages.missingDescription);if(!o)throw new Error(a.ErrorMessagesForTasksController.missingResponsible);if(!u)throw new Error(a.GeneralErrorMessages.missingStatus);if(!c)throw new Error(a.ErrorMessagesForTasksController.missingSubTasks);return void 0,[4,(c&&c.length>0?new i.TasksModel({deadline:new Date(t),description:s,idProject:r,responsible:o,status:u,subTasks:c}):new i.TasksModel({deadline:new Date(t),description:s,idProject:r,responsible:o,status:u})).save()];case 2:return[2,n.sent()];case 3:throw(l=n.sent()).message===a.GeneralErrorMessages.missingIdProject||l.message===a.GeneralErrorMessages.missingDeadline||l.message===a.GeneralErrorMessages.invalidDate||l.message===a.GeneralErrorMessages.missingDescription||l.message===a.ErrorMessagesForTasksController.missingResponsible||l.message===a.GeneralErrorMessages.missingStatus||l.message===a.ErrorMessagesForTasksController.missingSubTasks?l:(console.error(l),new Error(a.ErrorMessagesForTasksController.problemStoringTasks));case 4:return[2]}}))}))},e.prototype._update=function(){return s(this,void 0,void 0,(function(){var e,r,t,s,o,u,c,l,f;return n(this,(function(n){switch(n.label){case 0:e=this._args,r=e.id,t=e.deadline,s=e.description,o=e.responsible,u=e.status,c=e.subTasks,n.label=1;case 1:if(n.trys.push([1,6,,7]),!t)throw new Error(a.GeneralErrorMessages.missingDeadline);if("Invalid Date"===new Date(t).toString())throw new Error(a.GeneralErrorMessages.invalidDate);if(!s)throw new Error(a.GeneralErrorMessages.missingDescription);if(!o)throw new Error(a.ErrorMessagesForTasksController.missingResponsible);if(!u)throw new Error(a.GeneralErrorMessages.missingStatus);if(!c)throw new Error(a.ErrorMessagesForTasksController.missingSubTasks);return l=void 0,c.length>0?[4,i.TasksModel.findByIdAndUpdate(r,{deadline:new Date(t),description:s,responsible:o,status:u,subTasks:c},{new:!0})]:[3,3];case 2:return l=n.sent(),[3,5];case 3:return[4,i.TasksModel.findByIdAndUpdate(r,{deadline:new Date(t),description:s,responsible:o,status:u},{new:!0})];case 4:l=n.sent(),n.label=5;case 5:return[2,l];case 6:throw(f=n.sent()).message===a.GeneralErrorMessages.missingDeadline||f.message===a.GeneralErrorMessages.invalidDate||f.message===a.GeneralErrorMessages.missingDescription||f.message===a.ErrorMessagesForTasksController.missingResponsible||f.message===a.GeneralErrorMessages.missingStatus||f.message===a.ErrorMessagesForTasksController.missingSubTasks?f:(console.error(f),new Error(a.ErrorMessagesForTasksController.problemStoringTasks));case 7:return[2]}}))}))},e.prototype._updateStatus=function(){return s(this,void 0,void 0,(function(){var e,r,t,s;return n(this,(function(n){switch(n.label){case 0:e=this._args,r=e.id,t=e.status,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,i.TasksModel.findByIdAndUpdate(r,{status:t})];case 2:return[2,n.sent()];case 3:throw s=n.sent(),console.error(s),s;case 4:return[2]}}))}))},e}();r.Tasks=u},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.TasksModel=void 0;var s=t(0),n=t(24),o=new s.Schema({code:{required:!1,type:String,unique:!0},idProject:{ref:"projects",required:!0,type:s.Schema.Types.ObjectId},responsible:{required:!0,type:[String]},subTasks:[String]}),i=n.extendSchema(o),a=s.model("tasks",i);r.TasksModel=a},function(e,r,t){"use strict";var s=this&&this.__assign||function(){return(s=Object.assign||function(e){for(var r,t=1,s=arguments.length;t<s;t++)for(var n in r=arguments[t])Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n]);return e}).apply(this,arguments)};Object.defineProperty(r,"__esModule",{value:!0}),r.extendSchema=void 0;var n=t(0),o=t(5);r.extendSchema=function(e){return new n.Schema(s(s(s({},o.CommonDataForProjectsTasksAndJobOffers.obj),e.obj),{status:{required:!0,type:String}}))}},function(e,r,t){"use strict";var s=this&&this.__awaiter||function(e,r,t,s){return new(t||(t=Promise))((function(n,o){function i(e){try{u(s.next(e))}catch(e){o(e)}}function a(e){try{u(s.throw(e))}catch(e){o(e)}}function u(e){var r;e.done?n(e.value):(r=e.value,r instanceof t?r:new t((function(e){e(r)}))).then(i,a)}u((s=s.apply(e,r||[])).next())}))},n=this&&this.__generator||function(e,r){var t,s,n,o,i={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,s&&(n=2&o[0]?s.return:o[0]?s.throw||((n=s.return)&&n.call(s),0):s.next)&&!(n=n.call(s,o[1])).done)return n;switch(s=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,s=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(n=i.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){i.label=o[1];break}if(6===o[0]&&i.label<n[1]){i.label=n[1],n=o;break}if(n&&i.label<n[2]){i.label=n[2],i.ops.push(o);break}n[2]&&i.ops.pop(),i.trys.pop();continue}o=r.call(e,i)}catch(e){o=[6,e],s=0}finally{t=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(r,"__esModule",{value:!0}),r.Users=void 0;var o=t(1),i=t(2),a=t(26),u=o.Router();r.Users=u,u.route("/users/").get((function(e,r){return s(void 0,void 0,void 0,(function(){var t,s,o,u;return n(this,(function(n){switch(n.label){case 0:t=e.query.type,s=new a.Users,n.label=1;case 1:switch(n.trys.push([1,8,,9]),t){case"clients":return[3,2];case"supervisor":return[3,4]}return[3,6];case 2:return[4,s.process("getAllClients")];case 3:return o=n.sent(),i.response(!1,{result:o},r,200),[3,7];case 4:return[4,s.process("getAllSupervisors")];case 5:return o=n.sent(),i.response(!1,{result:o},r,200),[3,7];case 6:i.response(!0,"Request not allowed",r,500),n.label=7;case 7:return[3,9];case 8:return u=n.sent(),i.response(!0,u.message,r,500),[3,9];case 9:return[2]}}))}))})),u.route("/users/getSupervisorsByProject/:idProject").get((function(e,r){return s(void 0,void 0,void 0,(function(){var t,s,o,u;return n(this,(function(n){switch(n.label){case 0:t=e.params.idProject,s=new a.Users(t),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,s.process("getSupervisorsByProject")];case 2:return o=n.sent(),i.response(!1,{result:o},r,200),[3,4];case 3:return u=n.sent(),i.response(!0,u.message,r,500),[3,4];case 4:return[2]}}))}))}))},function(e,r,t){"use strict";var s=this&&this.__assign||function(){return(s=Object.assign||function(e){for(var r,t=1,s=arguments.length;t<s;t++)for(var n in r=arguments[t])Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n]);return e}).apply(this,arguments)},n=this&&this.__awaiter||function(e,r,t,s){return new(t||(t=Promise))((function(n,o){function i(e){try{u(s.next(e))}catch(e){o(e)}}function a(e){try{u(s.throw(e))}catch(e){o(e)}}function u(e){var r;e.done?n(e.value):(r=e.value,r instanceof t?r:new t((function(e){e(r)}))).then(i,a)}u((s=s.apply(e,r||[])).next())}))},o=this&&this.__generator||function(e,r){var t,s,n,o,i={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,s&&(n=2&o[0]?s.return:o[0]?s.throw||((n=s.return)&&n.call(s),0):s.next)&&!(n=n.call(s,o[1])).done)return n;switch(s=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,s=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(n=i.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){i.label=o[1];break}if(6===o[0]&&i.label<n[1]){i.label=n[1],n=o;break}if(n&&i.label<n[2]){i.label=n[2],i.ops.push(o);break}n[2]&&i.ops.pop(),i.trys.pop();continue}o=r.call(e,i)}catch(e){o=[6,e],s=0}finally{t=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.Users=void 0;var a=i(t(27)),u=t(7),c=function(){function e(e){void 0===e&&(e=null),this._args=e||[],this._usersRef=global.firestoreDatabase.collection("users")}return e.prototype.process=function(e){switch(e){case"getAllClients":return this._getAllClients();case"getAllSupervisors":return this._getAllSupervisors();case"getSupervisorsByProject":return this._getSupervisorsByProject();default:return}},e.prototype._getAllClients=function(){return n(this,void 0,void 0,(function(){var e=this;return o(this,(function(r){switch(r.label){case 0:return[4,this._usersRef.where("role","==","client").get()];case 1:return r.sent().docs.map((function(r){return e._args.push(s(s({},r.data()),{id:r.id}))})),[2,this._args]}}))}))},e.prototype._getAllSupervisors=function(){return n(this,void 0,void 0,(function(){var e=this;return o(this,(function(r){switch(r.label){case 0:return[4,this._usersRef.where("role","==","supervisor").get()];case 1:return r.sent().docs.map((function(r){return e._args.push(s(s({},r.data()),{id:r.id}))})),[2,this._args]}}))}))},e.prototype._getSupervisorsByProject=function(){return n(this,void 0,void 0,(function(){var e,r,t,n,i,c;return o(this,(function(o){switch(o.label){case 0:e=this._args,r=new u.Projects({id:e}),o.label=1;case 1:return o.trys.push([1,4,,5]),[4,r.process("getSupervisorsIdByProject")];case 2:return t=o.sent(),[4,this._usersRef.where(a.default.FieldPath.documentId(),"in",t.supervisors).get()];case 3:return n=o.sent(),i=[],console.log(n.size),n.docs.map((function(e){return i.push(s(s({},e.data()),{id:e.id}))})),[2,i];case 4:throw c=o.sent(),console.error(c),new Error("idk");case 5:return[2]}}))}))},e}();r.Users=c},function(e,r){e.exports=require("@google-cloud/firestore")},function(e,r,t){"use strict";var s=this&&this.__awaiter||function(e,r,t,s){return new(t||(t=Promise))((function(n,o){function i(e){try{u(s.next(e))}catch(e){o(e)}}function a(e){try{u(s.throw(e))}catch(e){o(e)}}function u(e){var r;e.done?n(e.value):(r=e.value,r instanceof t?r:new t((function(e){e(r)}))).then(i,a)}u((s=s.apply(e,r||[])).next())}))},n=this&&this.__generator||function(e,r){var t,s,n,o,i={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,s&&(n=2&o[0]?s.return:o[0]?s.throw||((n=s.return)&&n.call(s),0):s.next)&&!(n=n.call(s,o[1])).done)return n;switch(s=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,s=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(n=i.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){i.label=o[1];break}if(6===o[0]&&i.label<n[1]){i.label=n[1],n=o;break}if(n&&i.label<n[2]){i.label=n[2],i.ops.push(o);break}n[2]&&i.ops.pop(),i.trys.pop();continue}o=r.call(e,i)}catch(e){o=[6,e],s=0}finally{t=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.firebaseConnection=void 0;var i=o(t(29)),a=t(30),u={auth_provider_x509_cert_url:process.env.FIREBASE_AUTH_PROVIDER_X509_CERT_URL,auth_uri:process.env.FIREBASE_AUTH_URI,client_email:process.env.FIREBASE_CLIENT_EMAIL,client_id:process.env.FIREBASE_CLIENT_ID,client_x509_cert_url:process.env.FIREBASE_X509_CERT,private_key:process.env.FIREBASE_PRIVATE_KEY,private_key_id:process.env.FIREBASE_PRIVATE_KEY_ID,project_id:process.env.FIREBASE_PROJECT_ID,token_uri:process.env.FIREBASE_TOKEN_URI,type:process.env.FIREBASE_TYPE};r.firebaseConnection=function(){return s(void 0,void 0,void 0,(function(){var e;return n(this,(function(r){switch(r.label){case 0:return[4,a.writeJson(process.env.GOOGLE_APPLICATION_CREDENTIALS,JSON.stringify(u).replace(/\\\\/g,"\\"),"utf8")];case 1:return r.sent(),e=i.default.initializeApp({credential:i.default.credential.applicationDefault(),databaseURL:process.env.FIREBASE_URL}),[4,a.deleteFile(process.env.GOOGLE_APPLICATION_CREDENTIALS)];case 2:return r.sent(),global.firestoreDatabase=i.default.firestore(e),console.log("Firebase connection established."),[2]}}))}))}},function(e,r){e.exports=require("firebase-admin")},function(e,r,t){"use strict";var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.writeJson=r.deleteFile=void 0;var n=s(t(31));r.writeJson=function(e,r,t){return new Promise((function(s,o){n.default.writeFile(e,r,t,(function(e){e?o(e):s("Success")}))}))};r.deleteFile=function(e){return new Promise((function(r,t){n.default.unlink(e,(function(e){e?t(e):r("Success")}))}))}},function(e,r){e.exports=require("fs")},function(e,r,t){"use strict";var s=this&&this.__assign||function(){return(s=Object.assign||function(e){for(var r,t=1,s=arguments.length;t<s;t++)for(var n in r=arguments[t])Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n]);return e}).apply(this,arguments)},n=this&&this.__awaiter||function(e,r,t,s){return new(t||(t=Promise))((function(n,o){function i(e){try{u(s.next(e))}catch(e){o(e)}}function a(e){try{u(s.throw(e))}catch(e){o(e)}}function u(e){var r;e.done?n(e.value):(r=e.value,r instanceof t?r:new t((function(e){e(r)}))).then(i,a)}u((s=s.apply(e,r||[])).next())}))},o=this&&this.__generator||function(e,r){var t,s,n,o,i={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,s&&(n=2&o[0]?s.return:o[0]?s.throw||((n=s.return)&&n.call(s),0):s.next)&&!(n=n.call(s,o[1])).done)return n;switch(s=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,s=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(n=i.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){i.label=o[1];break}if(6===o[0]&&i.label<n[1]){i.label=n[1],n=o;break}if(n&&i.label<n[2]){i.label=n[2],i.ops.push(o);break}n[2]&&i.ops.pop(),i.trys.pop();continue}o=r.call(e,i)}catch(e){o=[6,e],s=0}finally{t=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.mongoConnection=void 0;var a=i(t(0)),u=a.default.connection,c={keepAlive:!0,useCreateIndex:!0,useFindAndModify:!1,useNewUrlParser:!0,useUnifiedTopology:!0};u.on("connected",(function(){console.log("Mongo connection established.")})),u.on("reconnected",(function(){console.log("Mongo connection reestablished.")})),u.on("disconnected",(function(){console.log("Mongo connection disconnected."),console.log("Trying to reconnected to Mongo..."),setTimeout((function(){a.default.connect(process.env.MONGO_URI,s(s({},c),{connectTimeoutMS:3e3,socketTimeoutMS:3e3}))}),3e3)})),u.on("close",(function(){console.log("Mongo connection closed.")})),u.on("error",(function(e){console.log("Mongo connection error:"),console.error(e)}));r.mongoConnection=function(){return n(void 0,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return[4,a.default.connect(process.env.MONGO_URI,c)];case 1:return e.sent(),[2]}}))}))}},function(e,r,t){"use strict";var s=this&&this.__awaiter||function(e,r,t,s){return new(t||(t=Promise))((function(n,o){function i(e){try{u(s.next(e))}catch(e){o(e)}}function a(e){try{u(s.throw(e))}catch(e){o(e)}}function u(e){var r;e.done?n(e.value):(r=e.value,r instanceof t?r:new t((function(e){e(r)}))).then(i,a)}u((s=s.apply(e,r||[])).next())}))},n=this&&this.__generator||function(e,r){var t,s,n,o,i={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,s&&(n=2&o[0]?s.return:o[0]?s.throw||((n=s.return)&&n.call(s),0):s.next)&&!(n=n.call(s,o[1])).done)return n;switch(s=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,s=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(n=i.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){i.label=o[1];break}if(6===o[0]&&i.label<n[1]){i.label=n[1],n=o;break}if(n&&i.label<n[2]){i.label=n[2],i.ops.push(o);break}n[2]&&i.ops.pop(),i.trys.pop();continue}o=r.call(e,i)}catch(e){o=[6,e],s=0}finally{t=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.mysqlConnection=void 0;var i=o(t(34)),a={client:"mysql",connection:{database:process.env.MYSQL_DATABASE,host:process.env.MYSQL_HOST,password:process.env.MYSQL_PASS,user:process.env.MYSQL_USER}};r.mysqlConnection=function(){return s(void 0,void 0,void 0,(function(){var e;return n(this,(function(r){switch(r.label){case 0:global.mysqlDatabase=i.default(a),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,global.mysqlDatabase.raw("SELECT 'test connection';")];case 2:return r.sent(),console.log("MySql connection established."),[3,4];case 3:return e=r.sent(),console.error(e),[3,4];case 4:return[2]}}))}))}},function(e,r){e.exports=require("knex")}]);